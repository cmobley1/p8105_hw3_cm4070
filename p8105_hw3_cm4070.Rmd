---
title: "p8105_hw3_cm4070"
output: github_document
---

```{r loadlibraries_plots}
library(tidyverse)
library(patchwork)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6, 
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options( 
  ggplot2.continuous.colour = "viridis", 
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Question 1

### Load data

```{r}
library(p8105.datasets)

data("instacart") 
```

There are `r nrow(instacart)` observations and `r ncol(instacart)` variables, and key variable names are `r names(instacart)` in the `instacart` data. 

### Describe aisles with plot

```{r}
instacart %>% 
  count(aisle, name = "n_columns") %>% 
  arrange(desc(n_columns)) %>% 
  filter(n_columns > 10000) %>% 
  mutate(aisle = forcats::fct_reorder(aisle, n_columns)) %>% 
  ggplot(aes(x = n_columns, y = aisle, color = aisle)) + geom_point() +
  labs(title = "Aisles' Popularity plot", 
    x = "number of items ordered in each aisle",
    y = "aisle name",
    caption = "Data from â€œThe Instacart Online Grocery Shopping Dataset 2017"
    ) +
    scale_x_continuous(
      limits = c(10000, 170000))
```

There are approximately 134 aisles. The aisles most ordered from are fresh vegetables, fresh fruits, and packaged vegetables and fruits. We can see this in the above plot where we see the number of items ordered in each aisle with its respective name and the values at approximately 150000 values are those most popular.

### Make a table with three most popular items within 3 aisles 

```{r}
popular_items =
  instacart %>% 
  group_by(aisle, product_name) %>% 
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>%
  summarize(n_obs = n()) %>%
  arrange(desc(n_obs)) %>%
  slice(1:3) %>%
  knitr::kable(digits = 1))
  popular_items
```

